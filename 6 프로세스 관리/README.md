# 칼리 리눅스 실습 6

## 프로세스 확인
 - ps : 실행 중인 프로세스 확인
 - 커널은 프로세스가 생성될 때 각 프로세스에 고유한 프로세스ID(PID)를 순차적으로 할당한다.
 - 옵션 없이 ps 명령을 실행하면 현재 로그인한 사용자가 시작한 프로세스와 해당 터미널에서 실행중인 프로세스가 나열된다.
 - ps aux : 모든 사용자에 대해 실행 중인 모든 프로세스를 보여준다.
 ```
 USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  2.0  0.6  22364 14048 ?        Ss   22:46   0:00 /sbin/init 첫 프로세스 = init
root           2  0.0  0.0      0     0 ?        S    22:46   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        S    22:46   0:00 [pool_work
root           4  0.0  0.0      0     0 ?        I<   22:46   0:00 [kworker/R
root           5  0.0  0.0      0     0 ?        I<   22:46   0:00 [kworker/R
...
kali        1360  0.0  0.3 308568  6656 ?        Ssl  22:46   0:00 /usr/libex
kali        1384  0.0  0.4 533672  8448 ?        Sl   22:46   0:00 /usr/libex
kali        1392  0.0  0.3 234092  6400 ?        Ssl  22:46   0:00 /usr/libex
kali        1403  0.1  0.3  46720  7552 ?        Ss   22:46   0:00 /usr/libex
kali        1433  4.0  4.7 454840 95700 ?        Sl   22:46   0:00 /usr/bin/q
kali        1436  2.2  0.3  10376  6576 pts/0    Ss   22:46   0:00 /usr/bin/z
root        1482  0.0  0.0      0     0 ?        I    22:46   0:00 [kworker/u
kali        1612 50.0  0.1   8376  3840 pts/0    R+   22:47   0:00 ps aux 마지막 프로세스 = ps aux
 USER : 프로세스를 호출한 사용자
 PID : 프로세스 ID
 %CPU : 프로세스가 사용중인 CPU 백분율
 %MEM : 프로세스가 사용중인 메모리의 백분율
 COMMAND : 프로세스를 시작한 명령의 이름
 ```

### 프로세스 필터링
 - 모든 프로세스를 나타나게 하면 눈으로 보기 어렵기 때문에 필터링이 필요하다.
 - msfconsole : 침투 프레임워크 중의 하나이다. Metasploit 침투 프레임워크를 이용한다.
 - ps aux | grep msfconsole : 특정 프로세스를 찾기 위해 ps 검색 필터링 가능
 - top : 프로세스 중에 리소스 사용량이 많은 것부터 정렬되게 하여 나타낸다. (3초마다 새로고침한다.)
 - H 또는 ? 키를 누르면 대화형 명령 목록이 표시되고 Q를 누르면 top을 종료한다.

## 프로세스 관리
 - 해커는 종종 다중 처리를 필요로 하며 칼리와 같은 운영체제가 이러한 조건에 적합하다.
 - 해커는 취약점 스캐너와 침투를 동시에 실행하는 동안 포트 스캐너를 실행할 수 있다.
 - 이를 위해 해커는 시스템 리소스를 최대한 활용하고 태스크를 완료하기 위해 이러한 프로세스를 효율적으로 관리해야 한다.
 - nice로 프로세스 우선순위를 변경할 수 있다.
 - nice 값의 범위는 -20~+19까지이며 기본값은 0이다. nice가 낮으면 우선순위가 높고, nice가 높으면 우선순위가 낮다.
 - nice 명령으로 우선순위 수준을 설정(up)한 다음 renice 명령으로 프로세스 실행이 시작된 후 우선순위를 변경(절댓값 이용)할 수 있다.
 - nice -n -10 /bin/slowprocess -> nice를 -10만큼 증가시켜 우선순위를 키운다.
 - nice -n 10 /bin/slowprocess -> nice를 10만큼 증가시켜 우선순위를 낮춘다.
 - renice 19 6996(PID) -> 이미 실행중인 프로세스의 경우 renice를 쓴다. PID가 6996인 프로세스의 nice값을 19로 정한다.
 - top 에서도 nice를 변경할 수 있다. 최상위 유틸리티가 실행 중인 상태에서 R키를 누르고 PID,nice 값을 제공하면 변경된다.
 - R을 누르면 renice PID [value] to value라는 텍스트와 함께 PID를 입력하라는 메시지가 뜬다.

## 프로세스 종료
 - 프로세스가 이상할 경우 freeze되기도 한다. 이런 프로세스를 로그(rogue) 프로세스라고 한다.
 - 문제가 있을 경우 kill 명령으로 종료할 수도 있다. kill에는 64개의 다른 kill 시그널이 있다. 이 중에서 중요한 것만 보자.
 1. SIGHUP,1,멈춰있는(hangup)시그널이다. 지정된 프로세스를 중단하고 동일한 PID로 다시 시작한다.
 2. SIGINT,2,인터럽트 시그널이다. 작업이 보장되지 않는 약한 종료 시그널이지만 대부분의 경우 작동은 된다.
 3. SIGQUIT,3,코어 덤프다. 프로세스에 오류가 생겼을 경우 프로세스 정보를 메모리,현재 작업 디렉터리의 core라는 파일에 저장한다.(오류 저장,수정용)
 4. SIGTERM,15,이것은 종료 시그널이다. kill 명령의 기본 kill 신호다.
 5. SIGKILL,9,절대적인 종료 시그널이다. 프로세스의 리소스를 특수 장치인 /dev/null로 보내 프로세스를 강제로 중지한다.
 - 예시로 kill -1 6996, kill -9 6996,killall(프로세스 이름으로 없앰.) -9 rogueprocess 등이 있다.
 - leafpad newscript -> leafpad newscript & 일 경우 백그라운드에서 텍스트 편집기를 시작한다. 그리고 명령 프롬프트는 새 것을 만든다.
 - fg 1234 -> PID가 1234인 프로세스를 포그라운드 프로세스로 옮긴다.

## 프로세스 예약 실행
 - 리눅스에서는 프로세스를 예약 실행하기 위해 at,crond 명령을 사용할 수 있다.
 - at 명령은 데몬(백그라운드 프로세스) atd를 설정하는데 사용되며, 원하는 작업이 미래의 특정 시점에 한 번은 실해되도록 예약한다.
 - crond 데몬은 매일, 매주, 또는 매월 발생하는 작업을 예약하는데 더 적합하다. (16장에서 자세히 함.)
 ex) at 7:20am 엔터를 누르면 at은 대화식 모드로 전환되고 at> 프롬프트가 표시된다.<br>
 at> /root/myscanningscript -> myscanningscript 파일이 오늘 오전 7시 20분에 실행되도록 예약하는 것이다.<br>
 예약을 중단하고 싶을 때 ctrl-D를 누르면 된다.
 
